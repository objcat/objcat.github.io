# ğŸ ç®€ä»‹

å­—èŠ‚è·³åŠ¨å¹¿å‘Šå¹³å°

# ğŸ å¹³å°

## ğŸŒ² æ³¨å†Œ

ç›´æ¥å»å®˜ç½‘æ³¨å†Œ

https://www.csjplatform.com
## ğŸŒ² åˆ›å»ºåº”ç”¨

![](images/Pasted%20image%2020231116111518.png)

æ²¡æœ‰è®¤è¯ç­¾çº¦åªèƒ½åˆ›å»ºæµ‹è¯•åº”ç”¨, ä¸èƒ½äº§ç”Ÿæ”¶ç›Š

## ğŸŒ² åˆ›å»ºä»£ç ä½

![](images/Pasted%20image%2020231116111731.png)

ä»£ç ä½å°±æ˜¯å¹¿å‘Šid, ä½ åœ¨appé‡ŒæŠ•æ”¾çš„æ¯ä¸€ä¸ªå¹¿å‘Šéƒ½è¦ä¸€ä¸ªä»£ç ä½, æˆ‘ä»¬ç‚¹å‡»åˆ›å»º

![](images/Pasted%20image%2020231116111851.png)

æ¯”å¦‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¼€å±å¹¿å‘Š, åˆ›å»ºå®Œæ¯•åæˆ‘ä»¬åˆ·æ–°é¡µé¢å°±èƒ½æ˜¾ç¤ºå‡ºæ¥äº†

![](images/Pasted%20image%2020231116112201.png)

å¯ä»¥çœ‹åˆ°ä¸‹é¢æœ‰ä¸€ä¸²id, è¿™æ˜¯æˆ‘ä»¬çš„`å¹¿å‘Šid`ä¹Ÿå«`postId`

# ğŸ flutteré›†æˆ

æ²¡æœ‰å®˜æ–¹çš„æ’ä»¶, åªæœ‰ç¬¬ä¸‰æ–¹æ’ä»¶

æ’ä»¶1:
https://pub-web.flutter-io.cn/packages/pangle_flutter
https://juejin.cn/post/6859188620772048904?searchId=20231116104227C0B39D8B56DAEE1CD31C

æ’ä»¶2:
https://pub.dev/packages/flutter_pangle_ads
https://juejin.cn/post/7041461489789566989?searchId=20231116104227C0B39D8B56DAEE1CD31C

### ğŸŒ¸ å¹³å°æ³¨å†Œ

åœ¨ç©¿å±±ç”²å¹³å°æ³¨å†Œä¸€ä¸ªæµ‹è¯•åº”ç”¨, è‡ªå·±æ

### ğŸŒ¸ å¯¼å…¥ä¾èµ–

æˆ‘ä»¬ä½¿ç”¨`æ’ä»¶2`æ¥ä¸¾ä¾‹å­

```
flutter pub add flutter_pangle_ads
```

### ğŸŒ¸ åˆå§‹åŒ–æ’ä»¶

```dart
void main() {
  runApp(const MyApp());
  FlutterPangleAds.initAd("5446772");
}
```

### ğŸŒ¸ å¼€å±å¹¿å‘Š

```dart
void main() {
  runApp(const MyApp());
  FlutterPangleAds.initAd("5446772");
  /// [posId] å¹¿å‘Šä½ id
  FlutterPangleAds.showSplashAd(posId);
}
```

ç„¶åè¿è¡Œå‘ç°èµ·ä¸æ¥äº†

```shell
Launching lib/main.dart on M2012K11AC in debug mode...
Running Gradle task 'assembleDebug'...
æ³¨: æŸäº›è¾“å…¥æ–‡ä»¶ä½¿ç”¨æˆ–è¦†ç›–äº†å·²è¿‡æ—¶çš„ APIã€‚
æ³¨: æœ‰å…³è¯¦ç»†ä¿¡æ¯, è¯·ä½¿ç”¨ -Xlint:deprecation é‡æ–°ç¼–è¯‘ã€‚
æ³¨: æŸäº›è¾“å…¥æ–‡ä»¶ä½¿ç”¨äº†æœªç»æ£€æŸ¥æˆ–ä¸å®‰å…¨çš„æ“ä½œã€‚
æ³¨: æœ‰å…³è¯¦ç»†ä¿¡æ¯, è¯·ä½¿ç”¨ -Xlint:unchecked é‡æ–°ç¼–è¯‘ã€‚
ERROR:D8: Cannot fit requested classes in a single dex file (# methods: 71173 > 65536)
com.android.builder.dexing.DexArchiveMergerException: Error while merging dex archives: 
The number of method references in a .dex file cannot exceed 64K.
Learn how to resolve this issue at https://developer.android.com/tools/building/multidex.html
	at com.android.builder.dexing.D8DexArchiveMerger.getExceptionToRethrow(D8DexArchiveMerger.java:151)
	at com.android.builder.dexing.D8DexArchiveMerger.mergeDexArchives(D8DexArchiveMerger.java:138)
	at com.android.build.gradle.internal.tasks.DexMergingWorkAction.merge(DexMergingTask.kt:859)
	at com.android.build.gradle.internal.tasks.DexMergingWorkAction.run(DexMergingTask.kt:805)
	at com.android.build.gradle.internal.profile.ProfileAwareWorkAction.execute(ProfileAwareWorkAction.kt:74)
	at org.gradle.workers.internal.DefaultWorkerServer.execute(DefaultWorkerServer.java:63)
	at org.gradle.workers.internal.NoIsolationWorkerFactory$1$1.create(NoIsolationWorkerFactory.java:66)
	at org.gradle.workers.internal.NoIsolationWorkerFactory$1$1.create(NoIsolationWorkerFactory.java:62)
	at org.gradle.internal.classloader.ClassLoaderUtils.executeInClassloader(ClassLoaderUtils.java:100)
	at org.gradle.workers.internal.NoIsolationWorkerFactory$1.lambda$execute$0(NoIsolationWorkerFactory.java:62)
	at org.gradle.workers.internal.AbstractWorker$1.call(AbstractWorker.java:44)
	at org.gradle.workers.internal.AbstractWorker$1.call(AbstractWorker.java:41)
	at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:204)
	at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:199)
	at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:66)
	at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:59)
	at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:157)
	at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:59)
	at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:53)
	at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:73)
	at org.gradle.workers.internal.AbstractWorker.executeWrappedInBuildOperation(AbstractWorker.java:41)
	at org.gradle.workers.internal.NoIsolationWorkerFactory$1.execute(NoIsolationWorkerFactory.java:59)
	at org.gradle.workers.internal.DefaultWorkerExecutor.lambda$submitWork$2(DefaultWorkerExecutor.java:205)
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source)
	at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.runExecution(DefaultConditionalExecutionQueue.java:187)
	at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.access$700(DefaultConditionalExecutionQueue.java:120)
	at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner$1.run(DefaultConditionalExecutionQueue.java:162)
	at org.gradle.internal.Factories$1.create(Factories.java:31)
	at org.gradle.internal.work.DefaultWorkerLeaseService.withLocks(DefaultWorkerLeaseService.java:249)
	at org.gradle.internal.work.DefaultWorkerLeaseService.runAsWorkerThread(DefaultWorkerLeaseService.java:109)
	at org.gradle.internal.work.DefaultWorkerLeaseService.runAsWorkerThread(DefaultWorkerLeaseService.java:114)
	at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.runBatch(DefaultConditionalExecutionQueue.java:157)
	at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.run(DefaultConditionalExecutionQueue.java:126)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source)
	at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:64)
	at org.gradle.internal.concurrent.ManagedExecutorImpl$1.run(ManagedExecutorImpl.java:48)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: com.android.tools.r8.CompilationFailedException: Compilation failed to complete, position: null
	at Version.fakeStackEntry(Version_3.3.70.java:0)
	at com.android.tools.r8.internal.Fj.a(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:75)
	at com.android.tools.r8.internal.Fj.a(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:28)
	at com.android.tools.r8.internal.Fj.a(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:27)
	at com.android.tools.r8.internal.Fj.b(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:2)
	at com.android.tools.r8.D8.run(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:11)
	at com.android.builder.dexing.D8DexArchiveMerger.mergeDexArchives(D8DexArchiveMerger.java:136)
	... 38 more
Caused by: com.android.tools.r8.internal.f: Cannot fit requested classes in a single dex file (# methods: 71173 > 65536)
	at com.android.tools.r8.internal.JT.a(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:14)
	at com.android.tools.r8.internal.JT.a(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:22)
	at com.android.tools.r8.internal.n30.a(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:524)
	at com.android.tools.r8.internal.i30.a(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:7)
	at com.android.tools.r8.internal.F2.a(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:371)
	at com.android.tools.r8.internal.F2.a(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:455)
	at com.android.tools.r8.D8.d(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:756)
	at com.android.tools.r8.D8.b(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:1)
	at com.android.tools.r8.internal.Fj.a(R8_3.3.70_49b71801b8b3de79ea68cec3bf950786c8f90f7a560cea4a2d23a82079b17d04:24)
	... 41 more


FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':app:mergeExtDexDebug'.
> A failure occurred while executing com.android.build.gradle.internal.tasks.DexMergingTaskDelegate
   > There was a failure while executing work items
      > A failure occurred while executing com.android.build.gradle.internal.tasks.DexMergingWorkAction
         > com.android.builder.dexing.DexArchiveMergerException: Error while merging dex archives: 
           The number of method references in a .dex file cannot exceed 64K.
           Learn how to resolve this issue at https://developer.android.com/tools/building/multidex.html

* Try:
> Run with --stacktrace option to get the stack trace.
> Run with --info or --debug option to get more log output.
> Run with --scan to get full insights.

* Get more help at https://help.gradle.org

BUILD FAILED in 1m 16s
[!] App requires Multidex support
    Multidex support is required for your android app to build since the number of methods has exceeded 64k. See https://docs.flutter.dev/deployment/android#enabling-multidex-support for more information. You may pass the --no-multidex flag to skip Flutter's multidex support to use a manual solution.

    Flutter tool can add multidex support. The following file will be added by flutter:

        android/app/src/main/java/io/flutter/app/FlutterMultiDexApplication.java

cannot prompt without a terminal ui
Exception: Gradle task assembleDebug failed with exit code 1
```

ç„¶åæˆ‘æ‰“å¼€äº†flutteré¡¹ç›®ä¸­çš„åŸç”Ÿå®‰å“å‘ç°å¯ä»¥è¿è¡Œ, çœ‹æ¥æ˜¯flutterçš„é—®é¢˜, ç½‘ä¸Šè¯´ä½¿ç”¨`flutter clean`ä½†æ˜¯æˆ‘è¯•äº†æ²¡ç”¨, åæ¥åœ¨å®‰å“é‡Œé…ç½®ä¸€ä¸‹å°±å¥½äº†

```groovy
defaultConfig {
	...
	multiDexEnabled true
	...
}
```

### ğŸŒ¸ æ–°æ’å±å¹¿å‘Š

![](images/Pasted%20image%2020231116132840.png)

### ğŸŒ¸ ä¿¡æ¯æµå¹¿å‘Š

ä¿¡æ¯æµä¸å…¶ä»–å¹¿å‘Šä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯, ä¸èƒ½ç›´æ¥ä½¿ç”¨`ä»£ç ä½`, å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªåˆ—è¡¨

```dart
asyncAd() async {
    List<int> feedAdList = await FlutterPangleAds.loadFeedAd(
      "954359034"
    );
    print("å‡ºæ¥äº†");
    print(feedAdList);
  }
```

ç„¶åæˆ‘ä»¬ä¼šå‘ç°ä¸è¡Œäº†, å¦‚æœé—®é¢˜æ˜¯ç½‘ç»œè¯·æ±‚çš„é—®é¢˜å°±é…ç½®ä¸Šå»

```xml
<application
		...
        android:networkSecurityConfig="@xml/network_security_config"
        android:usesCleartextTraffic="true"
        ...
```

ç„¶åæˆ‘ä»¬å¯èƒ½ä¼šå‘ç°ä¸‹é¢çš„é—®é¢˜, åŠ ä¸Š`tools:replace="android:networkSecurityConfig"`å³å¯
```shell
Launching lib/main.dart on M2012K11AC in debug mode...
Running Gradle task 'assembleDebug'...
/Users/objcat/project/Flutter/ldtg/android/app/src/debug/AndroidManifest.xml Error:
	Attribute application@networkSecurityConfig value=(@xml/network_security_config) from (unknown)
	is also present at [:flutter_pangle_ads] AndroidManifest.xml:31:9-60 value=(@xml/network_config).
	Suggestion: add 'tools:replace="android:networkSecurityConfig"' to <application> element at AndroidManifest.xml:3:5-36:19 to override.

FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':app:processDebugMainManifest'.
> Manifest merger failed : Attribute application@networkSecurityConfig value=(@xml/network_security_config) from (unknown)
  	is also present at [:flutter_pangle_ads] AndroidManifest.xml:31:9-60 value=(@xml/network_config).
  	Suggestion: add 'tools:replace="android:networkSecurityConfig"' to <application> element at AndroidManifest.xml:3:5-36:19 to override.

* Try:
> Run with --stacktrace option to get the stack trace.
> Run with --info or --debug option to get more log output.
> Run with --scan to get full insights.

* Get more help at https://help.gradle.org

BUILD FAILED in 10s
Exception: Gradle task assembleDebug failed with exit code 1
```

ç„¶åå‘ç°è·å–åˆ°äº†

```shell
2023-11-16 14:23:15.178  7304-7354  flutter                 com.objcat.ldtg                      I  å‡ºæ¥äº†
2023-11-16 14:23:15.178  7304-7354  flutter                 com.objcat.ldtg                      I  [84393812]
```

æ˜¯ä¸€ä¸ªæ•°ç»„, é‡Œé¢æ”¾äº†id, æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªidæ¥åŠ è½½å¹¿å‘Šäº†

```dart
AdFeedWidget(
posId: '${feedAdList[0]}',
width: 375,
height: 128,
show: true,
)
```